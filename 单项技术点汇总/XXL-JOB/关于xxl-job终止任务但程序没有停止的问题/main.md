## 关于xxl-job终止任务但程序没有停止的问题

### 1、问题的现象
在使用XXL-JOB的时候，使用XxlJob注解创建了一个任务，计算任务的运行时间需要十多分钟，中途用户修改了计算任务的配置，
需要重新进行一次计算，***使用XXL-JOB的终止任务，控制台打印了程序已经终止，实际上程序还在运行***，带着疑惑去查看了XXl-JOB的源码

### 2、查找问题原因
查看终止任务调用的接口，接口调用地址 xxl-job-admin/joblog/logKill

以上代码主要做的事情：
- 1.根据任务主键去获取任务信息，根据任务主键去获取任务日志
- 2.根据日志实例中保存的执行器地址获取远程调度的实例类
- 3.调用远程客户端的kill，注意这个logKill是在xxl-job-admin服务中，也就是调度中心，至于为啥不直接调用客户端的kill，可以查阅

以上代码主要做的事情：
- 1、根据任务ID去获取线程
- 2、如果线程已经不存在了（执行完了或者异常中断了等）不进行操作
- 3、如果线程还存在调用线程的interrupt方法（问题找到了，原来只是调用了interrupt方法，但是代码没有对这个标识的处理）

### 3、问题的解决方式
方式一：
```
在代码保存结果的时候进行一次检查线程是否中断，但是会浪费很长一段时间
```

方式二：
```
在代码中增加多处checkpoint，每到一个checkpoint点就判断线程是否中断
```

- 在代码中增加多处checkpoint
- 每到一个checkpoint点就判断线程是否中断

















